# 베이지안 추론

> 실험을 통해 추가 정보를 얻은 다음, 베이즈 정리를 사용하여 가설 확률을 업데이트 하는 통계적  추론 방법
>
> - 다시말해, 사전 지식(경험)을 고려하여 관찰되는 증거를 분석하고, 이를 토대로 사후 확률을 추정하는 것.
>

데이터를 주어진 조건에 맞게 적응하도록 동적으로 분석할 때 주로 적용되며, 인공지능 분야에서는 사전 데이터로부터 배운 지식을 추가 데이터로 조건에 맞게 업데이트할 때 사용한다.

### 베이즈 정리를 이용한 베이지안 추론

- P(A): 사전 확률. '사건 A가 발생한다'라는 명제에 대한 믿음의 정도

- P(B): 증거. 측정을 통해 얻어진 B가 발생할 확률

- P(A|B): 사후확률. B라는 증거가 관찰된 후 명제에 대한 확률
  - 증거를 보고난 뒤, 변화된 믿음의 정도라고 할 수 있음

$$
P(A|B) = \frac{P(B|A)P(A)}{P(B)}
$$

#### 베이지안 추론의 예

- 사과와 배의 비율을 추정하고자 한다.
- 사과와 배가 일정 비율로 들어있을 때, 하나하나 꺼내보면서 확인본다.
- 누군가 사과와 배의 비율이 1:3이라고 알려주었고, '나'는 95%의 정도로 그것을 믿는다고 하자.

H: '사과와 배의 비율이 1:3이다.' 라는 명제

P(H): 0.95

P(E|H): 사과와 배의 비율이 1:3일 때, 사과가 뽑힐 가능성으로 0.25

E: 사과를 뽑는 경우

P(E)는 H가 맞을 때와 틀릴때 각각 사과를 뽑을 확률의 합
$$
P(E)=P(E|H)P(H)+P(E|H_{NOT})P(H_{NOT})
$$


##### 시행1: 사과를 꺼냄

사과의 비율이 더 작다는 정보가 주어진 상황에서 사과를 꺼낸 상황이다. 이와 같은 증거 E를 토대로 새롭게 추정한 사후확률P(H|E)는 다음과 같다.
$$
P(H|E)=\frac{P(E|H)P(H)}{P(E)}=\frac{P(E|H)P(H)}{P(E|H)P(H)+P(E|H_{NOT})P(H_{NOT})}
$$

$$
=\frac{0.25*0.95}{0.25*0.95+0.75*0.05}=0.8636
$$

즉, 사과와 배의 비율을 알려준 사람에 대한 신뢰도는 95%에서 86.36%으로 떨어진다.

##### 시행2: 사과를 꺼냄

P(H)는 첫 번째 시행에서 얻어진 0.8636이고, 베이지안 추론을 수행하면 다음과 같다.

$$
P(H|E)=\frac{P(E|H)P(H)}{P(E)}=\frac{P(E|H)P(H)}{P(E|H)P(H)+P(E|H_{NOT})P(H_{NOT})}
$$

$$
=\frac{0.25*0.8636}{0.25*0.8636+0.75*0.1364}=0.6785
$$

사후확률은 0.6758로 낮아진다.



##### 시행 3: 배를 꺼냄

P(H)는 두 번째 시행에서 얻어진 사후확률로 0.6785, 베이지안 추론의 결과는 다음과 같다.
$$
P(H|E)=\frac{P(E|H)P(H)}{P(E)}=\frac{P(E|H)P(H)}{P(E|H)P(H)+P(E|H_{NOT})P(H_{NOT})}
$$

$$
=\frac{0.25*0.6785}{0.25*0.6785+0.75*0.6785}=0.8636
$$

이런 방식으로 베이지안 추론은

- 사전지식을 고려하여
- 관찰되는 증거를 분석하고
- 위를 토대로 (사전지식에 대한) 사후확률을 추정한다



### 분류에서 베이지안 추론 적용

#### 나이브 베이즈 분류

새 데이터 분류시, 각 그룹에 속할 확률을 구하고 확률이 최대가 되는 그룹으로 해당 샘플을 분류한다.

- 질병1과 질병2가 있고, 만 명의 환자에 대해서 혈액에서 지표 단백질의 양(x)을 측정한다고 하자.
- 100명이 질병1, 9900명이 질병2에 걸렸다.
  - P(G1) = 0.01
  - P(G2) = 0.99
- 새로운 환자에 대해서 x가 측정되었을 때,  질병1에 걸렸을 확률은 P(G1|X)이고 질병2에 걸렸을 확률은 P(G2|X)인데, 이 중 큰 값에 해당 환자를 할당한다.

$$
P(G_1|x)=\frac{P(x|G_1)P(G_1)}{P(x)}=\frac{P(x|G_1)P(G_1)}{P(x|G_1)P(G_1)+P(x|G_2)P(G_2)}
$$



그룹 1인 100명에 대해서 x의 분포 P(x|G1)을 정하고,  

그룹 2인 9900명에 대해서도 P(x|G2)를 정하면 베이즈 추론 값을 계산할 수 있다.  

P(x|G1)=0.2, P(x|G2)=0.7이라고 하면,
$$
P(G_1|x)=\frac{0.2*0.01}{0.2*0.01+0.7*0.99}=0.29*10^{-2}
$$


이 되어 해당 환자는 그룹 2로 할당한다.



# 참고 사이트

[출처: 네이버 지식백과](https://terms.naver.com/entry.nhn?docId=5141513&cid=60266&categoryId=60266)